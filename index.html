<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق مواقيت الصلاة</title>
    <style>
        body {
            background-color: #ffccff;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        h1 {
            color: #ff66b2;
        }
        .button {
            background-color: #ff66b2;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 10px 2px;
            cursor: pointer;
        }
        .button:hover {
            background-color: #ff3399;
        }
        .prayer-times {
            margin-top: 20px;
        }
        .input-container {
            margin: 20px;
        }
        .input-container input {
            padding: 10px;
            font-size: 16px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>تطبيق مواقيت الصلاة</h1>

    <div class="input-container">
        <input type="text" id="cityName" placeholder="أدخل اسم المدينة">
        <button class="button" onclick="getPrayerTimes()">البحث</button>
    </div>

    <button class="button" onclick="changeColor()">تغيير اللون</button>

    <div class="prayer-times">
        <h2 id="cityNameHeader">مواقيت الصلاة</h2>
        <p>الفجر: <span id="fajr">--:--</span></p>
        <p>الظهر: <span id="dhuhr">--:--</span></p>
        <p>العصر: <span id="asr">--:--</span></p>
        <p>المغرب: <span id="maghrib">--:--</span></p>
        <p>العشاء: <span id="isha">--:--</span></p>
    </div>

    <script>
        const colors = [
            '#ffccff', '#ccffcc', '#ccffff', '#ffcccc', '#ccccff',
            '#ffffcc', '#ffebcc', '#e6ccff', '#ffcc99', '#ff99cc',
            '#99ccff', '#ff9966', '#ccff99'
        ];

        let currentColorIndex = 0;

        function changeColor() {
            currentColorIndex = (currentColorIndex + 1) % colors.length;
            document.body.style.backgroundColor = colors[currentColorIndex];
        }

        async function getPrayerTimes() {
            const cityName = document.getElementById('cityName').value;
            if (!cityName) {
                alert('يرجى إدخال اسم المدينة');
                return;
            }

            // قائمة مفاتيح API التي سيتم استخدامها بالتتابع
            const apiKeys = [
                'b345048ac0697d437dc9bfeee18ffc70',
                'cbc51ce6b403bc63ab3729807141973a'
            ];
            let data;
            
            // محاولة استخدام كل مفتاح API بالتتابع حتى يتم العثور على واحد يعمل
            for (const apiKey of apiKeys) {
                const apiUrl = `https://api.aladhan.com/v1/timingsByCity?city=${cityName}&country=&method=2&key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl);
                    data = await response.json();
                    if (data.code === 200) {
                        break;  // كسر الحلقة إذا كانت الاستجابة ناجحة
                    }
                } catch (error) {
                    console.error(`Error using API key ${apiKey}:`, error);
                }
            }

            if (data && data.code === 200) {
                document.getElementById("cityNameHeader").innerText = `مواقيت الصلاة في ${cityName}`;
                document.getElementById("fajr").innerText = data.data.timings.Fajr;
                document.getElementById("dhuhr").innerText = data.data.timings.Dhuhr;
                document.getElementById("asr").innerText = data.data.timings.Asr;
                document.getElementById("maghrib").innerText = data.data.timings.Maghrib;
                document.getElementById("isha").innerText = data.data.timings.Isha;
            } else {
                alert('حدث خطأ في جلب مواقيت الصلاة. يرجى المحاولة مرة أخرى.');
            }
        }
    </script>
</body>
</html>
